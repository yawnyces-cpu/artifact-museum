<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ArtiFact Museum Guide</title>

    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
</head>

<body>
    <a-scene mindar-image="imageTargetSrc: ./assets/museum_collection.mind;" color-space="sRGB"
        renderer="colorManagement: true, physicallyCorrectLights" vr-mode-ui="enabled: false"
        device-orientation-permission-ui="enabled: false" raycaster="objects: .clickable"
        cursor="fuse: false; rayOrigin: mouse;">

        <a-camera look-controls="enabled: false"></a-camera>

    </a-scene>



    <script>
        const TOTAL_PAINTINGS = 3;
        const scene = document.querySelector('a-scene');


        // 1. Generate Targets
        for (let i = 0; i < TOTAL_PAINTINGS; i++) {
            let entity = document.createElement('a-entity');
            entity.setAttribute('mindar-image-target', `targetIndex: ${i}`);

            entity.userData = { paintingData: null };

            // --- Info Panel and Text ---
            let infoPanel = document.createElement('a-plane');
            infoPanel.setAttribute('position', '0 -0.8 0');
            infoPanel.setAttribute('width', '1.4');
            infoPanel.setAttribute('height', '0.6');
            infoPanel.setAttribute('color', '#111');
            infoPanel.setAttribute('opacity', '0.85');
            entity.appendChild(infoPanel);

            let infoText = document.createElement('a-text');
            infoText.setAttribute('position', '0 -0.75 0.05');
            infoText.setAttribute('align', 'center');
            infoText.setAttribute('color', 'white');
            infoText.setAttribute('width', '1.3');
            infoText.setAttribute('value', 'Scanning...');
            entity.appendChild(infoText);

            function createButton(label, xPos, sectionKey) {
                let btn = document.createElement('a-plane');
                btn.setAttribute('position', `${xPos} -1.2 0.1`);
                btn.setAttribute('width', '0.4');
                btn.setAttribute('height', '0.2');
                btn.setAttribute('color', '#333');
                btn.setAttribute('class', 'clickable');
                btn.setAttribute('opacity', '0.9');

                let btnText = document.createElement('a-text');
                btnText.setAttribute('value', label);
                btnText.setAttribute('align', 'center');
                btnText.setAttribute('color', '#FFD700');
                btnText.setAttribute('width', '1.5');
                btnText.setAttribute('position', '0 0 0.01');
                btn.appendChild(btnText);

                btn.addEventListener('click', () => {
                    const data = entity.userData.paintingData;
                    if (!data) return;

                    switch (sectionKey) {
                        case 'desc':
                            infoText.setAttribute('value', data.description);
                            break;
                        case 'history':
                            infoText.setAttribute('value', data.history);
                            break;
                        case 'artist':
                            infoText.setAttribute('value', "Artist: " + data.artist);
                            break;
                    }
                });

                entity.appendChild(btn);
            }

            createButton("INFO", -0.5, 'desc');
            createButton("HISTORY", 0, 'history');
            createButton("ARTIST", 0.5, 'artist');

            entity.addEventListener("targetFound", () => {
                let db_id = i + 1;
                fetch(`get_painting.php?id=${db_id}`)
                    .then(response => response.json())
                    .then(data => {
                        entity.userData.paintingData = data;
                        infoText.setAttribute('value', data.title);
                    });
            });

            scene.appendChild(entity);
        }

    </script>
</body>67

</html>